/**
 * Google Apps Script: 物件検索条件フォーム作成スクリプト（SUUMO風 v2）
 *
 * 使い方:
 *   1. Google Apps Script エディタでこのコードを貼り付ける
 *   2. SPREADSHEET_ID を設定済みか確認
 *   3. createSearchForm() を実行
 *   4. フォームが作成され、スプレッドシートに連携される
 *   5. 作成されたシート名を「検索条件」にリネームする
 *
 * フォーム列の順番 (A〜O):
 *   A: タイムスタンプ（自動）
 *   B: お名前
 *   C: 部屋探しの理由
 *   D: 都道府県
 *   E: 市区町村
 *   F: 路線名
 *   G: 駅名
 *   H: 賃料上限（万円）
 *   I: 間取りタイプ
 *   J: 駅徒歩
 *   K: 専有面積（m²以上）
 *   L: 築年数
 *   M: 建物の種類
 *   N: こだわり条件
 *   O: その他ご希望
 */

const SPREADSHEET_ID = "1u6NHowKJNqZm_Qv-MQQEDzMWjPOJfJiX1yhaO4Wj6lY";

function createSearchForm() {
  const form = FormApp.create("お部屋探し 検索条件フォーム");
  form.setDescription(
    "ご希望の条件をご入力ください。\n" +
    "条件に合う新着物件が見つかり次第、お知らせいたします。"
  );
  form.setConfirmationMessage(
    "ご登録ありがとうございます！\n" +
    "条件に合う新着物件が見つかり次第、お知らせいたします。"
  );

  // ── B列: お名前（必須） ─────────────────────────────────
  form.addTextItem()
    .setTitle("お名前")
    .setHelpText("例: 山田太郎")
    .setRequired(true);

  // ── C列: 部屋探しの理由 ─────────────────────────────────
  form.addListItem()
    .setTitle("部屋探しの理由")
    .setHelpText("当てはまるものを選択してください")
    .setChoiceValues([
      "転勤・転職",
      "就職",
      "進学（大学・専門学校）",
      "結婚",
      "同棲",
      "出産・家族が増える",
      "契約更新に伴う住み替え",
      "もっと広い部屋に住みたい",
      "もっと便利な場所に住みたい",
      "ペットを飼いたい",
      "その他"
    ])
    .setRequired(true);

  // ── D列: 都道府県（必須） ───────────────────────────────
  form.addListItem()
    .setTitle("都道府県")
    .setHelpText("お探しのエリアを選択してください")
    .setChoiceValues([
      "東京都", "神奈川県", "埼玉県", "千葉県"
    ])
    .setRequired(true);

  // ── E列: 市区町村 ───────────────────────────────────────
  form.addTextItem()
    .setTitle("市区町村")
    .setHelpText("カンマ（,）区切りで複数指定できます\n例: 千代田区, 中央区, 港区");

  // ── F列: 路線名 ─────────────────────────────────────────
  form.addTextItem()
    .setTitle("路線名")
    .setHelpText("ご希望の路線があれば入力してください\nカンマ（,）区切りで複数指定できます\n例: 山手線, 中央線, 東横線");

  // ── G列: 駅名 ───────────────────────────────────────────
  form.addTextItem()
    .setTitle("駅名")
    .setHelpText("ご希望の駅があれば入力してください\nカンマ（,）区切りで複数指定できます\n例: 渋谷, 新宿, 池袋");

  // ── H列: 賃料上限 ───────────────────────────────────────
  form.addListItem()
    .setTitle("賃料 上限（万円）")
    .setHelpText("管理費・共益費を除いた家賃の上限")
    .setChoiceValues([
      "上限なし",
      "3万円", "3.5万円", "4万円", "4.5万円",
      "5万円", "5.5万円", "6万円", "6.5万円",
      "7万円", "7.5万円", "8万円", "8.5万円",
      "9万円", "9.5万円", "10万円", "10.5万円",
      "11万円", "12万円", "13万円", "14万円", "15万円",
      "20万円", "25万円", "30万円", "35万円", "40万円", "50万円"
    ]);

  // ── I列: 間取りタイプ ───────────────────────────────────
  form.addCheckboxItem()
    .setTitle("間取りタイプ")
    .setHelpText("希望する間取りを選んでください（複数選択可）")
    .setChoiceValues([
      "ワンルーム", "1K", "1DK", "1LDK",
      "2K", "2DK", "2LDK",
      "3K", "3DK", "3LDK",
      "4K", "4DK", "4LDK",
      "5K以上"
    ]);

  // ── J列: 駅徒歩 ─────────────────────────────────────────
  form.addListItem()
    .setTitle("駅徒歩")
    .setHelpText("最寄り駅からの徒歩時間")
    .setChoiceValues([
      "指定しない",
      "1分以内", "3分以内", "5分以内",
      "7分以内", "10分以内", "15分以内", "20分以内"
    ]);

  // ── K列: 専有面積 ───────────────────────────────────────
  form.addListItem()
    .setTitle("専有面積（m²以上）")
    .setHelpText("最低限ほしい広さ")
    .setChoiceValues([
      "指定しない",
      "15m²", "20m²", "25m²", "30m²", "35m²",
      "40m²", "50m²", "60m²", "70m²", "80m²", "100m²"
    ]);

  // ── L列: 築年数 ─────────────────────────────────────────
  form.addListItem()
    .setTitle("築年数")
    .setHelpText("築何年以内の物件をお探しですか？")
    .setChoiceValues([
      "指定しない", "新築",
      "1年以内", "3年以内", "5年以内", "7年以内",
      "10年以内", "15年以内", "20年以内", "25年以内", "30年以内"
    ]);

  // ── M列: 建物の種類 ─────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("建物の種類")
    .setHelpText("希望する建物タイプを選んでください（複数選択可）")
    .setChoiceValues([
      "マンション", "アパート", "一戸建て・テラスハウス"
    ]);

  // ── N列: こだわり条件 ───────────────────────────────────
  form.addCheckboxItem()
    .setTitle("こだわり条件")
    .setHelpText("必要な条件を選んでください（複数選択可）")
    .setChoiceValues([
      "バス・トイレ別",
      "2階以上",
      "室内洗濯機置場",
      "エアコン付",
      "オートロック",
      "ペット相談",
      "独立洗面台",
      "追い焚き",
      "温水洗浄便座",
      "宅配ボックス",
      "浴室乾燥機",
      "モニター付きインターホン"
    ]);

  // ── O列: その他ご希望 ───────────────────────────────────
  form.addParagraphTextItem()
    .setTitle("その他ご希望")
    .setHelpText("上記以外にご希望の条件があればご記入ください\n例: 角部屋希望、南向き、駐車場付き など");

  // ── スプレッドシートに連携 ───────────────────────────────
  form.setDestination(FormApp.DestinationType.SPREADSHEET, SPREADSHEET_ID);

  Logger.log("フォームが作成されました！");
  Logger.log("編集URL: " + form.getEditUrl());
  Logger.log("回答URL: " + form.getPublishedUrl());
  Logger.log("");
  Logger.log("【重要】フォーム回答がスプレッドシートに保存されます。");
  Logger.log("作成されたシート名を「検索条件」にリネームしてください。");
}

/**
 * Google Apps Script: 物件検索条件フォーム作成スクリプト（SUUMO風 v3）
 *
 * 使い方:
 *   1. Google Apps Script エディタでこのコードを貼り付ける
 *   2. SPREADSHEET_ID を設定済みか確認
 *   3. createSearchForm() を実行
 *   4. フォームが作成され、スプレッドシートに連携される
 *   5. 作成されたシート名を「検索条件」にリネームする
 *
 * v3 変更点:
 *   - 路線名を会社別チェックボックスに変更（SUUMO準拠）
 *   - 8グループ: JR / 東京メトロ / 都営 / 東急 / 西武・東武 / 京王 / 京成・京急・小田急 / その他
 *
 * フォーム列の順番 (A〜V):
 *   A: タイムスタンプ（自動）
 *   B: お名前
 *   C: 部屋探しの理由
 *   D: 都道府県
 *   E: 市区町村
 *   F: JR路線
 *   G: 東京メトロ路線
 *   H: 都営路線
 *   I: 東急電鉄路線
 *   J: 西武・東武鉄道路線
 *   K: 京王電鉄路線
 *   L: 京成・京急・小田急路線
 *   M: その他路線
 *   N: 駅名
 *   O: 賃料上限（万円）
 *   P: 間取りタイプ
 *   Q: 駅徒歩
 *   R: 専有面積（m²以上）
 *   S: 築年数
 *   T: 建物の種類
 *   U: こだわり条件
 *   V: その他ご希望
 */

const SPREADSHEET_ID = "1u6NHowKJNqZm_Qv-MQQEDzMWjPOJfJiX1yhaO4Wj6lY";

function createSearchForm() {
  const form = FormApp.create("お部屋探し 検索条件フォーム");
  form.setDescription(
    "ご希望の条件をご入力ください。\n" +
    "条件に合う新着物件が見つかり次第、お知らせいたします。"
  );
  form.setConfirmationMessage(
    "ご登録ありがとうございます！\n" +
    "条件に合う新着物件が見つかり次第、お知らせいたします。"
  );

  // ── B列: お名前（必須） ─────────────────────────────────
  form.addTextItem()
    .setTitle("お名前")
    .setHelpText("例: 山田太郎")
    .setRequired(true);

  // ── C列: 部屋探しの理由 ─────────────────────────────────
  form.addListItem()
    .setTitle("部屋探しの理由")
    .setHelpText("当てはまるものを選択してください")
    .setChoiceValues([
      "転勤・転職",
      "就職",
      "進学（大学・専門学校）",
      "結婚",
      "同棲",
      "出産・家族が増える",
      "契約更新に伴う住み替え",
      "もっと広い部屋に住みたい",
      "もっと便利な場所に住みたい",
      "ペットを飼いたい",
      "その他"
    ])
    .setRequired(true);

  // ── D列: 都道府県（必須） ───────────────────────────────
  form.addListItem()
    .setTitle("都道府県")
    .setHelpText("お探しのエリアを選択してください")
    .setChoiceValues([
      "東京都", "神奈川県", "埼玉県", "千葉県"
    ])
    .setRequired(true);

  // ── E列: 市区町村 ───────────────────────────────────────
  form.addTextItem()
    .setTitle("市区町村")
    .setHelpText("カンマ（,）区切りで複数指定できます\n例: 千代田区, 中央区, 港区");

  // ══════════════════════════════════════════════════════════
  //  路線選択（会社別チェックボックス F〜M列）
  //  ※SUUMO 東京都 沿線一覧に準拠
  // ══════════════════════════════════════════════════════════

  // ── F列: JR路線 ───────────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("【JR】路線")
    .setHelpText("希望するJR路線を選んでください（複数選択可）")
    .setChoiceValues([
      "ＪＲ山手線",
      "ＪＲ京浜東北線",
      "ＪＲ東海道本線",
      "ＪＲ常磐線",
      "ＪＲ南武線",
      "ＪＲ横浜線",
      "ＪＲ横須賀線",
      "ＪＲ中央線",
      "ＪＲ青梅線",
      "ＪＲ五日市線",
      "ＪＲ武蔵野線",
      "ＪＲ八高線",
      "ＪＲ埼京線",
      "ＪＲ高崎線",
      "ＪＲ宇都宮線",
      "ＪＲ総武線",
      "ＪＲ総武線快速",
      "ＪＲ京葉線",
      "湘南新宿ライン宇須",
      "湘南新宿ライン高海"
    ]);

  // ── G列: 東京メトロ路線 ───────────────────────────────────
  form.addCheckboxItem()
    .setTitle("【東京メトロ】路線")
    .setHelpText("希望する東京メトロ路線を選んでください（複数選択可）")
    .setChoiceValues([
      "東京メトロ銀座線",
      "東京メトロ丸ノ内線",
      "東京メトロ日比谷線",
      "東京メトロ東西線",
      "東京メトロ千代田線",
      "東京メトロ有楽町線",
      "東京メトロ半蔵門線",
      "東京メトロ南北線",
      "東京メトロ副都心線"
    ]);

  // ── H列: 都営路線 ─────────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("【都営】路線")
    .setHelpText("希望する都営路線を選んでください（複数選択可）")
    .setChoiceValues([
      "都営浅草線",
      "都営三田線",
      "都営新宿線",
      "都営大江戸線",
      "都電荒川線",
      "日暮里・舎人ライナー"
    ]);

  // ── I列: 東急電鉄路線 ─────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("【東急電鉄】路線")
    .setHelpText("希望する東急電鉄路線を選んでください（複数選択可）")
    .setChoiceValues([
      "東急東横線",
      "東急田園都市線",
      "東急池上線",
      "東急目黒線",
      "東急多摩川線",
      "東急大井町線",
      "東急世田谷線"
    ]);

  // ── J列: 西武・東武鉄道路線 ───────────────────────────────
  form.addCheckboxItem()
    .setTitle("【西武・東武鉄道】路線")
    .setHelpText("希望する西武・東武鉄道路線を選んでください（複数選択可）")
    .setChoiceValues([
      "西武有楽町線",
      "西武新宿線",
      "西武池袋線",
      "西武拝島線",
      "西武国分寺線",
      "西武多摩川線",
      "西武多摩湖線",
      "西武豊島線",
      "東武東上線",
      "東武伊勢崎線",
      "東武亀戸線",
      "東武大師線"
    ]);

  // ── K列: 京王電鉄路線 ─────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("【京王電鉄】路線")
    .setHelpText("希望する京王電鉄路線を選んでください（複数選択可）")
    .setChoiceValues([
      "京王線",
      "京王新線",
      "京王井の頭線",
      "京王相模原線",
      "京王高尾線",
      "京王競馬場線",
      "京王動物園線"
    ]);

  // ── L列: 京成・京急・小田急路線 ───────────────────────────
  form.addCheckboxItem()
    .setTitle("【京成・京急・小田急】路線")
    .setHelpText("希望する路線を選んでください（複数選択可）")
    .setChoiceValues([
      "京成本線",
      "京成押上線",
      "京成金町線",
      "京急本線",
      "京急空港線",
      "小田急線",
      "小田急多摩線"
    ]);

  // ── M列: その他路線 ───────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("【その他】路線")
    .setHelpText("希望する路線を選んでください（複数選択可）")
    .setChoiceValues([
      "多摩都市モノレール",
      "りんかい線",
      "北総線",
      "東京モノレール",
      "新交通ゆりかもめ",
      "埼玉高速鉄道",
      "つくばエクスプレス",
      "成田スカイアクセス"
    ]);

  // ══════════════════════════════════════════════════════════
  //  路線選択ここまで
  // ══════════════════════════════════════════════════════════

  // ── N列: 駅名 ─────────────────────────────────────────────
  form.addTextItem()
    .setTitle("駅名")
    .setHelpText("ご希望の駅があれば入力してください\nカンマ（,）区切りで複数指定できます\n例: 渋谷, 新宿, 池袋");

  // ── O列: 賃料上限 ─────────────────────────────────────────
  form.addListItem()
    .setTitle("賃料 上限（万円）")
    .setHelpText("管理費・共益費を除いた家賃の上限")
    .setChoiceValues([
      "上限なし",
      "3万円", "3.5万円", "4万円", "4.5万円",
      "5万円", "5.5万円", "6万円", "6.5万円",
      "7万円", "7.5万円", "8万円", "8.5万円",
      "9万円", "9.5万円", "10万円", "10.5万円",
      "11万円", "12万円", "13万円", "14万円", "15万円",
      "20万円", "25万円", "30万円", "35万円", "40万円", "50万円"
    ]);

  // ── P列: 間取りタイプ ─────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("間取りタイプ")
    .setHelpText("希望する間取りを選んでください（複数選択可）")
    .setChoiceValues([
      "ワンルーム", "1K", "1DK", "1LDK",
      "2K", "2DK", "2LDK",
      "3K", "3DK", "3LDK",
      "4K", "4DK", "4LDK",
      "5K以上"
    ]);

  // ── Q列: 駅徒歩 ───────────────────────────────────────────
  form.addListItem()
    .setTitle("駅徒歩")
    .setHelpText("最寄り駅からの徒歩時間")
    .setChoiceValues([
      "指定しない",
      "1分以内", "3分以内", "5分以内",
      "7分以内", "10分以内", "15分以内", "20分以内"
    ]);

  // ── R列: 専有面積 ─────────────────────────────────────────
  form.addListItem()
    .setTitle("専有面積（m²以上）")
    .setHelpText("最低限ほしい広さ")
    .setChoiceValues([
      "指定しない",
      "15m²", "20m²", "25m²", "30m²", "35m²",
      "40m²", "50m²", "60m²", "70m²", "80m²", "100m²"
    ]);

  // ── S列: 築年数 ───────────────────────────────────────────
  form.addListItem()
    .setTitle("築年数")
    .setHelpText("築何年以内の物件をお探しですか？")
    .setChoiceValues([
      "指定しない", "新築",
      "1年以内", "3年以内", "5年以内", "7年以内",
      "10年以内", "15年以内", "20年以内", "25年以内", "30年以内"
    ]);

  // ── T列: 建物の種類 ───────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("建物の種類")
    .setHelpText("希望する建物タイプを選んでください（複数選択可）")
    .setChoiceValues([
      "マンション", "アパート", "一戸建て・テラスハウス"
    ]);

  // ── U列: こだわり条件 ─────────────────────────────────────
  form.addCheckboxItem()
    .setTitle("こだわり条件")
    .setHelpText("必要な条件を選んでください（複数選択可）")
    .setChoiceValues([
      "バス・トイレ別",
      "2階以上",
      "室内洗濯機置場",
      "エアコン付",
      "オートロック",
      "ペット相談",
      "独立洗面台",
      "追い焚き",
      "温水洗浄便座",
      "宅配ボックス",
      "浴室乾燥機",
      "モニター付きインターホン"
    ]);

  // ── V列: その他ご希望 ─────────────────────────────────────
  form.addParagraphTextItem()
    .setTitle("その他ご希望")
    .setHelpText("上記以外にご希望の条件があればご記入ください\n例: 角部屋希望、南向き、駐車場付き など");

  // ── スプレッドシートに連携 ─────────────────────────────────
  form.setDestination(FormApp.DestinationType.SPREADSHEET, SPREADSHEET_ID);

  Logger.log("フォームが作成されました！");
  Logger.log("編集URL: " + form.getEditUrl());
  Logger.log("回答URL: " + form.getPublishedUrl());
  Logger.log("");
  Logger.log("【重要】フォーム回答がスプレッドシートに保存されます。");
  Logger.log("作成されたシート名を「検索条件」にリネームしてください。");
}
